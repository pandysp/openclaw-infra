---
- name: Configure Telegram channel
  ansible.builtin.include_tasks: channel.yml

- name: Configure Telegram bindings
  ansible.builtin.include_tasks: bindings.yml

- name: Fix stale heartbeat session delivery targets
  ansible.builtin.include_tasks: session-cleanup.yml

- name: Configure cron jobs
  ansible.builtin.include_tasks: cron.yml
  when: >-
    (telegram_user_id is defined and telegram_user_id | length > 0) or
    (telegram_group_id is defined and telegram_group_id | length > 0) or
    (openclaw_agents | selectattr('deliver_channel', 'defined')
      | selectattr('deliver_channel', 'equalto', 'whatsapp') | list | length > 0) or
    (openclaw_agents | selectattr('deliver_channel', 'defined')
      | selectattr('deliver_channel', 'equalto', 'discord') | list | length > 0)
