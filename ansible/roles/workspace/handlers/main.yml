---
- name: reload user systemd
  ansible.builtin.systemd:
    daemon_reload: true
    scope: user
  environment:
    XDG_RUNTIME_DIR: "/run/user/1000"

- name: enable workspace timers
  ansible.builtin.systemd:
    name: "workspace-git-sync-{{ item.agent_id }}.timer"
    state: started
    enabled: true
    scope: user
  environment:
    XDG_RUNTIME_DIR: "/run/user/1000"
  loop: "{{ active_workspaces }}"
  loop_control:
    label: "{{ item.agent_id }}"
